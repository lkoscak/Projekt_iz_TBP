@{
    ViewBag.Title = "Find&Read";
}



<nav class="navbar navbar-expand-lg navbar-light bg-light">
    <a class="navbar-brand text-danger" href="#">Prijavite se</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarColor03" aria-controls="navbarColor03" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarColor03">
        <form class="form-inline my-2 my-lg-0">
            <input class="form-control mr-sm-2" type="text" placeholder="korisničko ime">
            <input class="form-control mr-sm-2" type="text" placeholder="lozinka">
            <button class="btn btn-outline-danger" type="submit">prijava</button>
        </form>
    </div>
</nav>
<br><br>
<div class="jumbotron">
    <h1 align="center" class="text-info">Find&Read</h1>
    <p class="lead" align="center">Najbolje stranica za ljubitelje knjiga kojima je jednostavno potrebna pomoć pri odabiru sljedeće pisane pustolovine</p>
    <p class="p-0" align="center">Odaberite jedan od kriterija i pronađite knjigu za sebe!</p>
</div>

<div class="row">
    <div class="col-md-3">
        <h2 class="text-danger">Preporuka prema ocjenama</h2>
        <p>
            Preporučene knjige prema prosječnoj ocijeni jednakoj ili većoj od odabranog kriterija!
        </p>
        <div class="form-group">
            <select id="ocjenaSelect" class="custom-select">
                <option value="0" selected="">Odaberite ocjenu</option>
                <option value="1">1+</option>
                <option value="2">2+</option>
                <option value="3">3+</option>
                <option value="4">4+</option>
                <option value="5">5</option>
            </select>
        </div>
    </div>
    <div class="col-md-3">
        <h2 class="text-warning">Preporuka prema razdoblju</h2>
        <p>Preporuka najčitanijih knjiga u odabranom vremenkom razdoblju</p>
        <div class="form-group">
            <select id="timeSelect" class="custom-select">
                <option value="0" selected="">Odaberite razdoblje</option>
                <option value="tjedan">Ovaj tjedan</option>
                <option value="mjesec">Ovaj mjesec</option>
                <option value="godina">Ovu godinu</option>
                <option value="sve">Od početka svijeta :D</option>
            </select>
        </div>
    </div>
    <div class="col-md-3">
        <h2 class="text-success">Preporuka prema omiljenom autoru</h2>
        <p>Knjige vašeg omiljenog autora sortirane prema prosječnoj ocijeni</p>
        <div class="form-group">
            <select id="authorSelect" class="custom-select">
            </select>
        </div>
    </div>
    <div class="col-md-3">
        <h2 class="text-info">Automatska preporuka</h2>
        <p>Automatska preporuka knjiga temeljem vaših pročitanih knjiga!</p>
        <button id="gumb" type="button" class="btn btn-outline-info" align="center">Preporuči knjige!</button>
    </div>
</div>
<br>
<div id="tablicaContainer" class="jumbotron">
    <h1 align="center" class="text-warning">Preporučene knjige</h1>
    <p class="lead" align="center">na temelju unesenog kriterija u tablici su dane preporučene knjige</p>

    <table id="tablicaPreporuka" class="table table-hover">
        <thead>
            <tr>
                <th scope="col">Naslov</th>
                <th scope="col">Autor</th>
                <th scope="col">Prosječna ocjena</th>
                <th scope="col">Broj čitanja</th>
            </tr>
        </thead>
        <tbody>
            
        </tbody>
    </table>
</div>

<script type="text/javascript">


    $(document).ready(function () {

        getAuthors();

        var rowColors = ["table-success", "table-warning", "table-danger", "table-info"];

        function getAuthors() {

            var autori = [];
           

            $.get("/Home/GetAuthors", null, function (data) {
                result = $.parseJSON(data);
                $.each(result, function (index, value) {
                    console.log(result[index].ime);
                    autori.push(result[index].ime);
                   
                    $('#authorSelect').append("<option value='" + result[index].ime + "'>" + result[index].ime + "</option>");

                });
            });

          
        }

        $("#ocjenaSelect").on('change', function (e) {

            var optionSelected = $("option:selected", this);
            var valueSelected = this.value;

            if (valueSelected != "0") {

                $([document.documentElement, document.body]).animate({
                    scrollTop: $("#tablicaContainer").offset().top
                }, 1000);

                $("#tablicaPreporuka tbody").empty();

                $.get("/Home/getBooksByRating", { rating: valueSelected }, function (data) {
                    result = $.parseJSON(data);
                    $.each(result, function (index, value) {
                        console.log(result[index]);
                        var color = rowColors[Math.floor(Math.random() * rowColors.length)];
                        $('#tablicaPreporuka > tbody:last-child').append('<tr><td class="' + color + '">' + result[index].knjiga.naslov +
                            '</td><td class="' + color + '">' + result[index].autor.ime + '</td><td class="' + color + '">' + result[index].prosjecnaOcjena + '</td><td class="' + color + '">' + result[index].brojCitanja +
                            '</td></tr>');

                    });
                });
            }

        });

        $("#authorSelect").on('change', function (e) {

            var optionSelected = $("option:selected", this);
            var valueSelected = this.value;

            if (valueSelected != "0") {

                $([document.documentElement, document.body]).animate({
                    scrollTop: $("#tablicaContainer").offset().top
                }, 1000);

                $("#tablicaPreporuka tbody").empty();

                $.get("/Home/GetAuthorsBooks", { autor: valueSelected }, function (data) {
                    result = $.parseJSON(data);
                    $.each(result, function (index, value) {
                        console.log(result[index]);
                        var color = rowColors[Math.floor(Math.random() * rowColors.length)];
                        $('#tablicaPreporuka > tbody:last-child').append('<tr><td class="' + color + '">' + result[index].knjiga.naslov +
                            '</td><td class="' + color + '">' + result[index].autor.ime + '</td><td class="' + color + '">' + result[index].prosjecnaOcjena + '</td><td class="' + color + '">' + result[index].brojCitanja +
                            '</td></tr>');

                    });
                });
            }

        });

        $("#timeSelect").on('change', function (e) {

            var optionSelected = $("option:selected", this);
            var valueSelected = this.value;

            if (valueSelected != "0") {

                $([document.documentElement, document.body]).animate({
                    scrollTop: $("#tablicaContainer").offset().top
                }, 1000);

                $("#tablicaPreporuka tbody").empty();

                $.get("/Home/getBooksByTime", { timeInterval: valueSelected }, function (data) {
                    result = $.parseJSON(data);
                    $.each(result, function (index, value) {
                        console.log(result[index]);
                        var color = rowColors[Math.floor(Math.random() * rowColors.length)];
                        $('#tablicaPreporuka > tbody:last-child').append('<tr><td class="' + color + '">' + result[index].knjiga.naslov +
                            '</td><td class="' + color + '">' + result[index].autor.ime + '</td><td class="' + color + '">' + result[index].prosjecnaOcjena + '</td><td class="' + color + '">' + result[index].brojCitanja +
                            '</td></tr>');

                    });
                });
            }

        });

       


       


        $("#selectPremaAutoru").click(function () {

            var autor = $('#autoriAutocomplete').val();

            $.get("/Home/GetAuthorsBooks", { autor: autor }, function (data) {
                alert(data);
                /*result = $.parseJSON(data);
                //console.log(result[0].name);
                $([document.documentElement, document.body]).animate({
                    scrollTop: $("#tablicaContainer").offset().top
                }, 1000);
                $("#tablicaPreporuka tbody").empty();
                $.each(result, function (index,value) {
                    console.log(result[index].name);
                    $('#tablicaPreporuka').focus();
                    $('#tablicaPreporuka > tbody:last-child').append('<tr><td>'+result[index].name+'</td></tr>');

                    });*/
                });
            });  
        });

    //});
</script>

